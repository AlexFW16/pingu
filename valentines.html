<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ÊÉÖ‰∫∫ÁØÄÂø´Ê®ÇÂá°‰∫ë!</title>
  <style>
    :root {
      --bg: #fff5f8;
      --card-bg: #fff;
      --accent: #ff4d4d;
      --text: #222;
      --muted: #666;
    }

    body,
    html {
      margin: 0;
      height: 100vh;
      width: 100vw;
      background: url('sad.png') center/center no-repeat;
      background-size: cover;
      background-attachment: fixed;
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }

    .wrap {
      min-height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 32px
    }

    .card {
      position: relative;
      width: 760px;
      max-width: 96%;
      background: var(--card-bg);
      border-radius: 14px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, .08);
      padding: 36px 28px;
      text-align: center;
      overflow: hidden;
    }

    h1 {
      margin: 0 0 18px;
      font-size: 32px;
      color: var(--text)
    }

    .buttons {
      position: relative;
      height: 220px;
      display: flex;
      align-items: center;
      justify-content: center
    }

    .yes {
      font-size: 28px;
      padding: 20px 40px;
      border-radius: 12px;
      border: none;
      background: var(--accent);
      color: white;
      cursor: pointer;
      box-shadow: 0 8px 18px rgba(255, 77, 77, .25);
      transition: transform .08s ease;
    }

    .yes:active {
      transform: scale(.98)
    }

    #noBtn {
      position: fixed;
      left: 12%;
      top: 55%;
      padding: 12px 18px;
      border-radius: 8px;
      border: 2px solid #ddd;
      background: #fafafa;
      cursor: pointer;
      transition: transform .08s ease, box-shadow .18s ease;
      z-index: 9999;
    }

    #noBtn:hover {
      box-shadow: 0 8px 18px rgba(0, 0, 0, .08)
    }

    /* images */
    .valentine-img {
      display: block;
      margin: 24px auto 0 auto;
      width: 70%;
      max-width: 420px;
      height: auto;
      border-radius: 12px;
      opacity: 0;
      transform: translateY(10px) scale(.98);
      transition: opacity .45s ease, transform .45s ease;
      pointer-events: none;
      position: relative;
      z-index: 100;
    }

    .valentine-img.show {
      opacity: 1;
      transform: translateY(0) scale(1);
    }

    .valentine-img.front {
      position: absolute;
      left: 50%;
      transform: translateX(-50%) translateY(10px);
      z-index: 300;
      width: 55%;
      max-width: 360px;
      pointer-events: auto;
    }

    /* particle */
    .particle {
      position: fixed;
      font-size: 24px;
      pointer-events: none;
      animation: floatUp 1.6s ease-out forwards;
      z-index: 10000;
    }

    @keyframes floatUp {
      0% {
        opacity: 1;
        transform: translateY(0) scale(1) rotate(0deg)
      }

      100% {
        opacity: 0;
        transform: translateY(-180px) scale(1.6) rotate(360deg)
      }
    }

    /* small screens */
    @media (max-width:520px) {
      h1 {
        font-size: 22px
      }

      .yes {
        font-size: 20px;
        padding: 16px 26px
      }

      .card {
        padding: 22px
      }

      .valentine-img {
        width: 80%;
        max-width: 260px
      }

      .valentine-img.front {
        width: 72%
      }
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="card" id="card">
      <h1>‰Ω†È°òÊÑèÁï∂ÊàëÁöÑÊÉÖ‰∫∫Âóé?</h1>
      <div class="buttons">
        <button id="noBtn" aria-label="No">‰∏çË¶Å</button>
        <button id="yesBtn" class="yes" aria-label="Yes">Ë¶Å</button>
      </div>
    </div>
  </div>

  <script>
    (function () {
      // state
      let backgroundChanged = false;
      let yesClicks = 0;
      const IMAGE_THRESHOLD = 3;
      const SECOND_IMAGE_THRESHOLD = 5;
      const SECRET_THRESHOLD = 10;

      // DOM
      const noBtn = document.getElementById('noBtn');
      const yesBtn = document.getElementById('yesBtn');
      const card = document.querySelector('.card');

      // messages + motion variables
      const messages = ["Hey, don't chase NO!", "Pingu, don't do this :(", "WHY ARE YOU DOING THIS!!"];
      let elapsedTime = 0, msgs = 0;
      let x = 200, y = 200, vx = 3, vy = 2.5, btnWidth = 0, btnHeight = 0;


      function tryAgain() {
        document.body.innerHTML = '';
        document.body.style.background = "url('sad.png') center/cover no-repeat";
        document.body.style.height = '100vh';
        setTimeout(() => alert('ÂÜçË©¶‰∏ÄÊ¨°ÔºÅ'), 200);
        setTimeout(() => location.reload(), 400);
      }
      function updateSize() {
        const rect = noBtn.getBoundingClientRect();
        btnWidth = rect.width; btnHeight = rect.height;
      }

      function updateStuff() {
        elapsedTime++;
        if (elapsedTime > 150) {
          if (msgs >= messages.length) tryAgain();
          else {alert(messages[msgs]); msgs++;}
          elapsedTime = 0;
        }
      }

      function animate() {
        x += vx; y += vy;
        vx *= 0.99; vy *= 0.99;
        const maxX = window.innerWidth - btnWidth;
        const maxY = window.innerHeight - btnHeight;
        if (x <= 0 || x >= maxX) {vx *= -1; x = Math.max(0, Math.min(x, maxX));}
        if (y <= 0 || y >= maxY) {vy *= -1; y = Math.max(0, Math.min(y, maxY));}
        noBtn.style.left = x + 'px'; noBtn.style.top = y + 'px';
        requestAnimationFrame(animate);
      }

      document.addEventListener('mousemove', (e) => {
        const centerX = x + btnWidth / 2, centerY = y + btnHeight / 2;
        const dx = centerX - e.clientX, dy = centerY - e.clientY;
        const dist = Math.hypot(dx, dy);
        const THRESHOLD = 140;
        if (dist < THRESHOLD) {
          updateStuff();
          const force = (THRESHOLD - dist) / THRESHOLD;
          vx += (dx / (dist || 1)) * force * 2;
          vy += (dy / (dist || 1)) * force * 2;
        }
      });

      // single scroll listener (bounces back image if present)
      let lastScroll = window.scrollY;
      window.addEventListener('scroll', () => {
        // try front first, then back
        const front = document.getElementById('valentineFront');
        const back = document.getElementById('valentineBack');
        const target = front || back;
        if (!target) return;
        const currentScroll = window.scrollY;
        // let direction = currentScroll > lastScroll ? 1 : -1;
        let direction = -1; // always up

        target.style.transform = (target.classList.contains('front')
          ? 'translateX(-50%) translateY(' + (direction * 100) + 'px)'
          : 'translateY(' + (direction * 20) + 'px)');
        setTimeout(() => {
          // reset transform depending on front or back
          if (target.classList.contains('front')) {
            target.style.transform = 'translateX(-50%) translateY(0)';
          } else {
            target.style.transform = 'translateY(0)';
          }
        }, 150);
        lastScroll = currentScroll;
      });

      // YES button behavior
      yesBtn.addEventListener('click', () => {
        yesClicks++;

        if (!backgroundChanged) {
          backgroundChanged = true;
          document.body.style.background = 'url("background.jpg") center/cover no-repeat fixed';
        }

        if (yesClicks < SECRET_THRESHOLD) {
          yesBtn.textContent = "üíñ Waaaaaa! üíñ";
          document.querySelector("h1").textContent = "Êàë‰πüÈ°òÊÑèÁï∂‰Ω†ÁöÑÊÉÖ‰∫∫ÔºÅ";
        }

        // particle burst
        const symbols = ["‚ù§Ô∏è", "üíñ", "üíï", "üå∏", "üå∫", "üíê"];
        const rect = yesBtn.getBoundingClientRect();
        const originX = rect.left + rect.width / 2;
        const originY = rect.top + rect.height / 2;
        for (let i = 0; i < 40; i++) {
          const p = document.createElement('div'); p.className = 'particle';
          p.textContent = symbols[Math.floor(Math.random() * symbols.length)];
          const angle = Math.random() * Math.PI * 2;
          const radius = Math.random() * 120;
          p.style.left = (originX + Math.cos(angle) * radius) + 'px';
          p.style.top = (originY + Math.sin(angle) * radius) + 'px';
          document.body.appendChild(p);
          setTimeout(() => p.remove(), 1600);
        }

        // first image at IMAGE_THRESHOLD
        if (yesClicks === IMAGE_THRESHOLD && !document.getElementById('valentineBack')) {
          const back = document.createElement('img');
          back.src = 'valentines.png';
          back.id = 'valentineBack';
          back.className = 'valentine-img';
          card.appendChild(back);
          // ensure transition triggers
          setTimeout(() => back.classList.add('show'), 40);
        }

        // second image at SECOND_IMAGE_THRESHOLD (overlaid on top)
        if (yesClicks === SECOND_IMAGE_THRESHOLD && !document.getElementById('valentineFront')) {
          const back = document.getElementById('valentineBack');
          // create front
          const front = document.createElement('img');
          front.src = 'valentines2.png'; // change if you want same image
          front.id = 'valentineFront';
          front.className = 'valentine-img front';
          front.style.opacity = '0';
          // append (absolute positioning CSS will keep it centered)
          card.appendChild(front);
          // once loaded, position top relative to back
          front.onload = () => {
            if (back) {
              const backRect = back.getBoundingClientRect();
              const cardRect = card.getBoundingClientRect();
              const topWithinCard = backRect.top - cardRect.top + (backRect.height - front.height) / 2;
              front.style.top = Math.max(8, topWithinCard) + 'px';
            } else {
              // fallback sensible top
              front.style.top = '24px';
            }
            setTimeout(() => {
              front.style.opacity = '1';
              front.style.transform = 'translateX(-50%) translateY(0)';
              front.classList.add('show');
            }, 30);
          };
          // if cached, onload might not fire => trigger manually after small delay
          setTimeout(() => {
            if (front.complete) front.onload && front.onload();
          }, 80);
        }

        // secret transformation at SECRET_THRESHOLD (change text -> link)
        if (yesClicks === SECRET_THRESHOLD) {
          yesBtn.textContent = 'Èü≥Ê®ÇÂêó?';
          yesBtn.onclick = () => window.open('https://soundofdanke.at/liebe/20aff91f2701c8550e20b378eb5ce8f6', '_blank');
          yesBtn.title = 'Click to visit your surprise!';
        }
      });

      // NO button
      noBtn.addEventListener('click', () => {
        tryAgain();

      });

      // start animation & sizes on load
      window.addEventListener('load', () => {updateSize(); animate();});
      window.addEventListener('resize', updateSize);

    })();
  </script>
</body>

</html>
